/** * Invoicex Copyright (c) 2005,2006,2007 Marco Ceccarelli, Tnx snc * * Questo software è soggetto, e deve essere distribuito con la licenza GNU * General Public License, Version 2. La licenza accompagna il software o potete * trovarne una copia alla Free Software Foundation http://www.fsf.org . * * This software is subject to, and may be distributed under, the GNU General * Public License, Version 2. The license should have accompanied the software * or you may obtain a copy of the license from the Free Software Foundation at * http://www.fsf.org . * * -- Marco Ceccarelli (m.ceccarelli@tnx.it) Tnx snc (http://www.tnx.it) * */package gestioneFatture;import it.tnx.Db;import gestioneFatture.logic.clienti.*;import it.tnx.accessoUtenti.Permesso;import it.tnx.commons.CastUtils;import it.tnx.commons.DbUtils;import it.tnx.commons.FormatUtils;import it.tnx.commons.JUtil;import it.tnx.commons.SwingUtils;import it.tnx.commons.table.EditorUtils;import it.tnx.commons.table.RendererUtils;import it.tnx.dbeans.ResultSet.*;import it.tnx.invoicex.IFunction;import it.tnx.invoicex.InvoicexUtil;import java.awt.Color;import java.awt.Component;import java.awt.Cursor;import java.io.File;import java.sql.ResultSet;import java.sql.Types;import java.text.*;import java.util.EventObject;import java.util.List;import java.util.Map;import java.util.Vector;import javax.swing.*;import javax.swing.JOptionPane;import javax.swing.event.TableModelEvent;import javax.swing.event.TableModelListener;import javax.swing.filechooser.FileFilter;import javax.swing.table.*;import javax.swing.text.JTextComponent;import org.apache.commons.lang.StringUtils;import tnxbeans.*;public class frmClie        extends javax.swing.JInternalFrame {    private static final int grandezzaTooltipImage = 150;    private static final int DOC_ORDINE = 0;    private static final int DOC_FATTURA = 1;    private static final int DOC_DDT = 2;    private DefaultTableModel tabPrezziClienteModel;    tnxbeans.tnxComboField comboToRefresh;    String listinoCliente = null;    public boolean isloading = true;    Component[] controlli = null;    public frmTestFatt padre = null;    private boolean isShowPrezziCliente = false;    /**     * Creates new form frmDati_blank     */    public frmClie() {        initComponents();        InvoicexUtil.macButtonSmall(butLogo);        InvoicexUtil.macButtonSmall(butBanca);        InvoicexUtil.macButtonGradient(butNew);        InvoicexUtil.macButtonGradient(butDele);        InvoicexUtil.macButtonGradient(butDuplica);        InvoicexUtil.macButtonGradient(butFind);        InvoicexUtil.macButtonGradient(butFirs);        InvoicexUtil.macButtonGradient(butPrev);        InvoicexUtil.macButtonGradient(butNext);        InvoicexUtil.macButtonGradient(butLast);        InvoicexUtil.macButtonGradient(butStampa);        InvoicexUtil.macButtonGradient(butStampaElenco);        InvoicexUtil.macButtonGradient(butImportExcel);        tabPrezziCliente.setRowHeight(tabPrezziCliente.getRowHeight() + 4);        dati.addCampoAggiuntivo(texNotaCliente);        textObsoleto.setVisible(false);//        if(!main.pluginRitenute){//            lblDataNasc.setVisible(false);//            lblLuogNasc.setVisible(false);//            this.texLuogoNascita.setVisible(false);//            this.texDataNascita.setVisible(false);//        } else {//            this.texLuogoNascita.dbNomeCampo = "luogoNascita";//            this.texLuogoNascita.dbNomeCampo = "dataNascita";//        }        controlli = new Component[]{texCodi, comTipo, texRagiSoci, texCodiFisc, texIndi, texCap, texLoca, texProv, texPersRife, comList, texPiva, texWeb, texEmai};        InvoicexUtil.fireEvent(this, InvoicexEvent.TYPE_FRMCLIE_CONSTR_POST_INIT_COMPS);//        final it.tnx.SwingWorker worker = new it.tnx.SwingWorker() {////            public Object construct() {        texGiornoPagamento.setEnabled(false);        //istanzio classse per riempire campi secondari banche        frmClie_tnxIntePanel tnxIntePanel = new frmClie_tnxIntePanel();        tnxIntePanel.labBancAbi = labBancAbi;        tnxIntePanel.labBancCab = labBancCab;        tnxIntePanel.texBancAbi = texBancAbi;        tnxIntePanel.texBancCab = texBancCab;        dati.riempiCampiSecondari = tnxIntePanel;        //apro la combo pagamenti        comPaga.dbOpenList(Db.getConn(), "select codice, codice from pagamenti order by codice", null, false);        //altre combo        comList.dbOpenList(Db.getConn(), "select descrizione, codice from tipi_listino", null, false);        comPaese.dbOpenList(Db.getConn(), "select nome, codice1 from stati", null, false);        comAgente.dbOpenList(Db.getConn(), "select nome, id from agenti order by nome", null, false);        comTipo.dbAddElement("Cliente", "C");        comTipo.dbAddElement("Fornitore", "F");        comTipo.dbAddElement("Cliente/Fornitore", "E");        comTipo.dbAddElement("Provvisorio", "P");        comTipo2.dbOpenList(Db.getConn(), "select descrizione, id from tipi_clie_forn order by descrizione", null, false);        //associo il panel ai dati        dati.dbNomeTabella = "clie_forn";        Vector chiave = new Vector();        chiave.add("codice");        dati.dbChiave = chiave;        dati.butSave = butSave;        dati.butUndo = butUndo;        dati.butFind = butFind;        dati.butDele = butDele;        dati.butNew = butNew;        dati.butDuplica = butDuplica;        dati.tipo_permesso = it.tnx.accessoUtenti.Permesso.PERMESSO_ANAGRAFICA_CLIENTI;        dati.messaggio_nuovo_manuale = true;        dati.dbOpen(Db.getConn(), "select * from clie_forn order by ragione_sociale limit 1");        dati.dbRefresh();        // Controlli aggiuntivi su pulsanti per aggiungere documenti        try {            if (!main.utente.getPermesso(Permesso.PERMESSO_FATTURE_VENDITA, Permesso.PERMESSO_TIPO_SCRITTURA)) {                addFatt.setEnabled(false);            }            if (!main.utente.getPermesso(Permesso.PERMESSO_DDT_VENDITA, Permesso.PERMESSO_TIPO_SCRITTURA)) {                addDdt.setEnabled(false);            }            if (!main.utente.getPermesso(Permesso.PERMESSO_ORDINI_VENDITA, Permesso.PERMESSO_TIPO_SCRITTURA)) {                addOrd.setEnabled(false);            }        } catch (Exception e) {            e.printStackTrace();        }        //apro la griglia        //this.griglia.dbEditabile = true;        griglia.dbChiave = chiave;        griglia.flagUsaThread = false;        java.util.Hashtable colsWidthPerc = new java.util.Hashtable();        colsWidthPerc.put("codice", new Double(10));        colsWidthPerc.put("ragione_sociale", new Double(30));        colsWidthPerc.put("telefono", new Double(13));        //colsWidthPerc.put("fax", new Double(13));        colsWidthPerc.put("email", new Double(10));        //colsWidthPerc.put("web", new Double(10));        colsWidthPerc.put("indirizzo", new Double(0));        colsWidthPerc.put("cap", new Double(0));        colsWidthPerc.put("localita", new Double(0));        colsWidthPerc.put("provincia", new Double(0));        colsWidthPerc.put("cod fis", new Double(10));        colsWidthPerc.put("partita iva", new Double(10));        griglia.columnsSizePerc = colsWidthPerc;//                griglia.dbOpen(Db.conn, "select codice,ragione_sociale,telefono,fax,email,web, indirizzo, cap, localita, provincia from clie_forn order by ragione_sociale");        griglia.dbOpen(Db.getConn(), "select " + getCampiGriglia() + " from clie_forn order by ragione_sociale");        griglia.dbPanel = dati;        griglia_rapporti.flagUsaThread = false;        java.util.Hashtable colsWidthPercRapporti = new java.util.Hashtable();        colsWidthPercRapporti.put("id", new Double(0));        colsWidthPercRapporti.put("cliente", new Double(0));        colsWidthPercRapporti.put("data", new Double(20));        colsWidthPercRapporti.put("data avviso", new Double(20));        colsWidthPercRapporti.put("testo", new Double(60));        griglia_rapporti.columnsSizePerc = colsWidthPercRapporti;        griglia_rapporti.dbOpen(Db.getConn(), "select id, cliente, data, data_avviso as 'data avviso', testo from clie_forn_rapporti where cliente = " + this.texCodi.getText());        //sistemo alcune cose        //this.comTipo.addItem("CL");        //this.comTipo.addItem("FO");        //events        comIvaStandard.dbAddElement("");        comIvaStandard.dbOpenList(Db.getConn(), "SELECT descrizione, codice FROM codici_iva");        if (!main.getPersonalContain("adesivi") && !main.getPersonalContain("noteclienti")) {            tabCent.remove(3);        } else {            dati.dbForzaModificati();        }        if (main.iniPrezziCliente == true) {            dati.addDbListener(new DbListener() {                public void statusFired(DbEvent event) {                    if (event.getStatus() == dati.STATUS_REFRESHING || event.getStatus() == dati.STATUS_ADDING) {                        showPrezziCliente();                    } else if (event.getStatus() == dati.STATUS_SAVING) {                        savePrezziCliente();                    }                }            });        } else {            tabCent.remove(2);        }        dati.addDbListener(new DbListener() {            public void statusFired(DbEvent event) {                if (event.getStatus() == dati.STATUS_REFRESHING || event.getStatus() == dati.STATUS_ADDING) {                    azzera_controlli(controlli);                    setNewStato();                } else if (event.getStatus() == dati.STATUS_SAVING) {                    azzera_controlli(controlli);                }            }        });        dati.dbRefresh();        comPagaItemStateChanged(null);        isloading = false;        this.texNotaCliente.setVisible(false);        InvoicexUtil.msgNew(this, dati, new IFunction() {            public void run() {                butNewActionPerformed(null);            }        }, comTipo, "Nessun cliente presente, prosegui con l'inserimento");//                return null;//            }//        };////        worker.start();    }    public void addNew() {        butNewActionPerformed(null);        this.tabCent.setSelectedIndex(0);//        setNewStato();        //this.show();    }    public void addNew(tnxbeans.tnxComboField combo) {        addNew();        this.comboToRefresh = combo;    }    private void azzera_controlli(Component[] component) {        for (Component c : component) {            if (c == comList) {                System.out.println("c = " + c);            }            c.setBackground(UIManager.getDefaults().getColor("TextField.background"));        }    }    public void openForm(int documento, final String codiceCliente) {        if (documento == DOC_ORDINE) {            frmTestOrdine frm = new frmTestOrdine(frmTestOrdine.DB_INSERIMENTO, "", 0, "P", 0, dbOrdine.TIPO_ORDINE, -1);            Menu m = (Menu) main.getPadre();            m.openFrame(frm, 740, InvoicexUtil.getHeightIntFrame(750));            frm.texClie.setText(codiceCliente);            frm.texClie.aggiornaComboAbbinata();            frm.recuperaDatiCliente();        } else if (documento == DOC_DDT) {            frmTestDocu frm = new frmTestDocu(frmTestDocu.DB_INSERIMENTO, "", 0, "P", 0, -1);            Menu m = (Menu) main.getPadre();            m.openFrame(frm, 740, InvoicexUtil.getHeightIntFrame(750));            frm.texClie.setText(codiceCliente);            frm.texClie.aggiornaComboAbbinata();            frm.recuperaDatiCliente();        } else if (documento == DOC_FATTURA) {            //controllo se sono aperti altri frmTestFatt            final frmTestFatt frm = new frmTestFatt(frmTestFatt.DB_INSERIMENTO, "", 0, "P", 0, dbFattura.TIPO_FATTURA_IMMEDIATA, -1);            Menu m = (Menu) main.getPadre();            m.openFrame(frm, 740, InvoicexUtil.getHeightIntFrame(750));            try {                frm.eseguiDopo(new Runnable() {                    public void run() {                        try {                            frm.texClie.setText(codiceCliente);                            frm.texClie.aggiornaComboAbbinata();                            frm.texCliente.setText(frm.comClie.getText());                            frm.selezionaCliente();                        } catch (Exception e) {                            e.printStackTrace();                        }                    }                });            } catch (Throwable t) {                t.printStackTrace();            }        }    }    private boolean controlla(Component[] component) {        String msg = "";        //controllo esistenza altro cliente/fornitore        if (dati.dbStato.equals(tnxDbPanel.DB_INSERIMENTO)                && (texRagiSoci.getText().length() > 0 || texPiva.getText().length() > 0 || texCodiFisc.getText().length() > 0)) {            String sql = "select codice, ragione_sociale, piva_cfiscale, cfiscale from clie_forn where (";            String w = "";            if (texRagiSoci.getText().length() > 0) {                w += " ragione_sociale like " + Db.pc(texRagiSoci.getText(), Types.VARCHAR);            }            if (texPiva.getText().length() > 0) {                if (w.length() > 0) {                    w += " or ";                }                w += " piva_cfiscale like " + Db.pc(texPiva.getText(), Types.VARCHAR);            }            if (texCodiFisc.getText().length() > 0) {                if (w.length() > 0) {                    w += " or ";                }                w += " cfiscale like " + Db.pc(texCodiFisc.getText(), Types.VARCHAR);            }            sql += w + ") and IFNULL(obsoleto, '0') != '1' limit 1";            try {                List<Map> list = DbUtils.getListMap(Db.getConn(), sql);                if (list.size() > 0) {                    Map m = list.get(0);                    msg += "Sembra sia già presente questa anagrafica:\n";                    msg += "Codice: " + m.get("codice") + "\n";                    msg += "Rag. Soc.: " + m.get("ragione_sociale") + "\n";                    msg += "P. Iva: " + m.get("piva_cfiscale") + "\n";                    msg += "C. Fiscale: " + m.get("cfiscale") + "\n";                    msg += "\nSicuro di continuare con l' inserimento ?";                    if (!SwingUtils.showYesNoMessage(this, msg)) {                        return false;                    }                }            } catch (Exception e) {                e.printStackTrace();            }        }        for (Component c : component) {            String campo = "";            if (c instanceof tnxTextField) {                tnxTextField t = (tnxTextField) c;                String s = t.getText();                if (s.length() == 0) {                    if (StringUtils.isNotEmpty(t.dbDescCampo)) {                        campo = t.dbDescCampo;                    } else {                        campo = t.dbNomeCampo;                    }                    msg += campo + "\n";                    t.setBackground(Color.RED.brighter());                } else {                    t.setBackground(UIManager.getDefaults().getColor("TextField.background"));                }            } else if (c instanceof tnxComboField) {                tnxComboField t = (tnxComboField) c;                String s = t.getText();                if (s.length() == 0) {                    if (StringUtils.isNotEmpty(t.dbDescCampo)) {                        campo = t.dbDescCampo;                    } else {                        campo = t.dbNomeCampo;                    }                    msg += campo + "\n";                    t.setBackground(Color.RED.brighter());                } else {                    t.setBackground(UIManager.getDefaults().getColor("TextField.background"));                }            }        }        //controllo piva e cfiscale        String altricontrolli = "";        if (texCodiFisc.getText().length() > 0 && texCodiFisc.getText().equalsIgnoreCase(texPiva.getText())) {            //partita iva e codice fiscale uguali        } else {            String ccf = JUtil.ControllaCF(texCodiFisc.getText());            if (ccf != null && ccf.length() > 0) {                altricontrolli += ccf + "\n";                texCodiFisc.setBackground(Color.YELLOW.brighter());            }        }        String cpiva = JUtil.ControllaPIVA(texPiva.getText());        if (cpiva != null && cpiva.length() > 0) {            altricontrolli += cpiva + "\n";            texPiva.setBackground(Color.YELLOW.brighter());        }        //listino        String sql = "select * from tipi_listino";        sql += " where codice = " + Db.pc(CastUtils.toString(comList.getSelectedKey()), java.sql.Types.VARCHAR);        ResultSet resu = Db.openResultSet(sql);        try {            if (resu.next() == false) {                altricontrolli += "Il listino non è stato scelto oppure non esiste più\n";                comList.setBackground(Color.YELLOW.brighter());            }        } catch (Exception err) {            err.printStackTrace();        }        //email e sito        if (texEmai.getText().length() > 0 && texEmai.getText().indexOf("@") <= 0) {            altricontrolli += "L' indirizzo email non è valido\n";            texEmai.setBackground(Color.YELLOW.brighter());        }        if (texWeb.getText().length() > 0 && texWeb.getText().indexOf("www.") < 0) {            altricontrolli += "L' indirizzo web non sembra essere valido\n";            texWeb.setBackground(Color.YELLOW.brighter());        }        if (msg.length() > 0 || altricontrolli.length() > 0) {            if (msg.length() > 0) {                msg = msg.substring(0, msg.length() - 1);                msg = "I seguenti campi non sono riempiti:\n" + msg;            }            if (altricontrolli.length() > 0) {                if (msg.length() > 0) {                    msg += "\n\n";                }                msg += "I seguenti campi presentano delle anomalie:\n" + altricontrolli;            }            msg += "\n" + "Continuare ?";            if (SwingUtils.showYesNoMessage(this, msg)) {                return true;            }            return false;        } else {            return true;        }    }    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents    private void initComponents() {        java.awt.GridBagConstraints gridBagConstraints;        jPopupMenu1 = new javax.swing.JPopupMenu();        popMenuAdd = new javax.swing.JMenuItem();        popMenuDel = new javax.swing.JMenuItem();        popMenuMod = new javax.swing.JMenuItem();        panAlto = new javax.swing.JPanel();        jToolBar1 = new javax.swing.JToolBar();        butNew = new javax.swing.JButton();        jLabel1 = new javax.swing.JLabel();        butDele = new javax.swing.JButton();        jLabel13 = new javax.swing.JLabel();        butFind = new javax.swing.JButton();        jLabel14 = new javax.swing.JLabel();        butDuplica = new javax.swing.JButton();        jLabel131 = new javax.swing.JLabel();        butFirs = new javax.swing.JButton();        butPrev = new javax.swing.JButton();        butNext = new javax.swing.JButton();        butLast = new javax.swing.JButton();        jLabel15 = new javax.swing.JLabel();        butStampaElenco = new javax.swing.JButton();        butStampa = new javax.swing.JButton();        butImportExcel = new javax.swing.JButton();        jToolBar2 = new javax.swing.JToolBar();        comFiltro1 = new javax.swing.JComboBox();        jToolBar3 = new javax.swing.JToolBar();        jLabel3 = new javax.swing.JLabel();        texSearch = new javax.swing.JTextField();        jButton3 = new javax.swing.JButton();        jSeparator2 = new javax.swing.JToolBar.Separator();        addFatt = new javax.swing.JButton();        addOrd = new javax.swing.JButton();        addDdt = new javax.swing.JButton();        tabCent = new javax.swing.JTabbedPane();        panDati = new javax.swing.JPanel();        jScrollPane2 = new javax.swing.JScrollPane();        dati = new tnxbeans.tnxDbPanel();        texCodiList = new tnxbeans.tnxTextField();        texCodiList.setVisible(false);        texRagiSoci = new tnxbeans.tnxTextField();        texPiva = new tnxbeans.tnxTextField();        texIndi = new tnxbeans.tnxTextField();        texProv = new tnxbeans.tnxTextField();        texLoca = new tnxbeans.tnxTextField();        texTele = new tnxbeans.tnxTextField();        texCap = new tnxbeans.tnxTextField();        texFax = new tnxbeans.tnxTextField();        texEmai = new tnxbeans.tnxTextField();        texWeb = new tnxbeans.tnxTextField();        texNote = new tnxbeans.tnxTextField();        texPersRife = new tnxbeans.tnxTextField();        texTeleRife = new tnxbeans.tnxTextField();        texCodiFisc = new tnxbeans.tnxTextField();        texBancAbi = new tnxbeans.tnxTextField();        jLabel2 = new javax.swing.JLabel();        jLabel21 = new javax.swing.JLabel();        jLabel22 = new javax.swing.JLabel();        jLabel211 = new javax.swing.JLabel();        jLabel221 = new javax.swing.JLabel();        jLabel231 = new javax.swing.JLabel();        jLabel212 = new javax.swing.JLabel();        jLabel222 = new javax.swing.JLabel();        jLabel232 = new javax.swing.JLabel();        jLabel25 = new javax.swing.JLabel();        jLabel241 = new javax.swing.JLabel();        jLabel233 = new javax.swing.JLabel();        jLabel223 = new javax.swing.JLabel();        jLabel213 = new javax.swing.JLabel();        jLabel2111 = new javax.swing.JLabel();        jLabel2211 = new javax.swing.JLabel();        jLabel26 = new javax.swing.JLabel();        butDest = new javax.swing.JButton();        jLabel224 = new javax.swing.JLabel();        comList = new tnxbeans.tnxComboField();        texCodi = new tnxbeans.tnxTextField();        jLabel214 = new javax.swing.JLabel();        jLabel215 = new javax.swing.JLabel();        texBancCab = new tnxbeans.tnxTextField();        jLabel216 = new javax.swing.JLabel();        texBancCc = new tnxbeans.tnxTextField();        butBanca = new javax.swing.JButton();        labBancAbi = new javax.swing.JLabel();        labBancCab = new javax.swing.JLabel();        comPaga = new tnxbeans.tnxComboField();        jLabel234 = new javax.swing.JLabel();        texCell = new tnxbeans.tnxTextField();        jLabel23 = new javax.swing.JLabel();        comPaese = new tnxbeans.tnxComboField();        jLabel225 = new javax.swing.JLabel();        comAgente = new tnxbeans.tnxComboField();        labGiornoPagamento = new javax.swing.JLabel();        texGiornoPagamento = new tnxbeans.tnxTextField();        jLabel226 = new javax.swing.JLabel();        comTipo = new tnxbeans.tnxComboField();        jLabel218 = new javax.swing.JLabel();        tnxCheckBox1 = new tnxbeans.tnxCheckBox();        updateListini = new tnxbeans.tnxCheckBox();        raggruppa1 = new tnxbeans.tnxCheckBox();        texBancCc2 = new tnxbeans.tnxTextField();        chkObsoleto = new javax.swing.JCheckBox();        textObsoleto = new tnxbeans.tnxTextField();        jLabel4 = new javax.swing.JLabel();        texLogo = new tnxbeans.tnxTextField();        butLogo = new javax.swing.JButton();        tnxCheckBox2 = new tnxbeans.tnxCheckBox();        comIvaStandard = new tnxbeans.tnxComboField();        jLabel7 = new javax.swing.JLabel();        raggruppa2 = new tnxbeans.tnxCheckBox();        jLabel217 = new javax.swing.JLabel();        texScon1 = new tnxbeans.tnxTextField();        texScon2 = new tnxbeans.tnxTextField();        texScon3 = new tnxbeans.tnxTextField();        jLabel219 = new javax.swing.JLabel();        texScon4 = new tnxbeans.tnxTextField();        texScon5 = new tnxbeans.tnxTextField();        jLabel227 = new javax.swing.JLabel();        comTipo2 = new tnxbeans.tnxComboField();        panElen = new javax.swing.JPanel();        jScrollPane1 = new javax.swing.JScrollPane();        griglia = new tnxbeans.tnxDbGrid();        panPrezzi = new javax.swing.JPanel();        jScrollPane3 = new javax.swing.JScrollPane();        tabPrezziCliente = new ClientiMyTable();        jPanel3 = new javax.swing.JPanel();        labIntePrezzi = new javax.swing.JLabel();        panNoteAvvisi = new javax.swing.JPanel();        jLabel5 = new javax.swing.JLabel();        jScrollPane4 = new javax.swing.JScrollPane();        griglia_rapporti = new tnxbeans.tnxDbGrid();        jLabel6 = new javax.swing.JLabel();        btnDelRigt = new javax.swing.JButton();        btnAddRow = new javax.swing.JButton();        butModiRow = new javax.swing.JButton();        texAreaNoteCliente = new javax.swing.JScrollPane();        texTesto = new javax.swing.JTextArea();        texNotaCliente = new tnxbeans.tnxTextField();        jPanel2 = new javax.swing.JPanel();        butUndo = new javax.swing.JButton();        butSave = new javax.swing.JButton();        popMenuAdd.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/list-add.png"))); // NOI18N        popMenuAdd.setText("Nuovo Rapporto");        popMenuAdd.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                popMenuAddActionPerformed(evt);            }        });        jPopupMenu1.add(popMenuAdd);        popMenuDel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/list-remove.png"))); // NOI18N        popMenuDel.setText("Elimina");        popMenuDel.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                popMenuDelActionPerformed(evt);            }        });        jPopupMenu1.add(popMenuDel);        popMenuMod.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/apps/accessories-text-editor.png"))); // NOI18N        popMenuMod.setText("Modifica");        popMenuMod.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                popMenuModActionPerformed(evt);            }        });        jPopupMenu1.add(popMenuMod);        setClosable(true);        setIconifiable(true);        setMaximizable(true);        setResizable(true);        setTitle("Clienti / Fornitori");        addInternalFrameListener(new javax.swing.event.InternalFrameListener() {            public void internalFrameActivated(javax.swing.event.InternalFrameEvent evt) {            }            public void internalFrameClosed(javax.swing.event.InternalFrameEvent evt) {            }            public void internalFrameClosing(javax.swing.event.InternalFrameEvent evt) {                formInternalFrameClosing(evt);            }            public void internalFrameDeactivated(javax.swing.event.InternalFrameEvent evt) {            }            public void internalFrameDeiconified(javax.swing.event.InternalFrameEvent evt) {            }            public void internalFrameIconified(javax.swing.event.InternalFrameEvent evt) {            }            public void internalFrameOpened(javax.swing.event.InternalFrameEvent evt) {            }        });        panAlto.setLayout(new java.awt.GridBagLayout());        jToolBar1.setFloatable(false);        jToolBar1.setRollover(true);        butNew.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/document-new.png"))); // NOI18N        butNew.setText("Nuovo");        butNew.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);        butNew.setMargin(new java.awt.Insets(2, 2, 2, 2));        butNew.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);        butNew.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butNewActionPerformed(evt);            }        });        jToolBar1.add(butNew);        jLabel1.setText(" ");        jToolBar1.add(jLabel1);        butDele.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/places/user-trash.png"))); // NOI18N        butDele.setText("Elimina");        butDele.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);        butDele.setMargin(new java.awt.Insets(2, 2, 2, 2));        butDele.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);        butDele.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butDeleActionPerformed(evt);            }        });        jToolBar1.add(butDele);        jLabel13.setText(" ");        jToolBar1.add(jLabel13);        butFind.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/edit-find.png"))); // NOI18N        butFind.setText("Trova");        butFind.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);        butFind.setMargin(new java.awt.Insets(2, 2, 2, 2));        butFind.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);        butFind.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butFindActionPerformed(evt);            }        });        jToolBar1.add(butFind);        jLabel14.setText(" ");        jToolBar1.add(jLabel14);        butDuplica.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/edit-copy.png"))); // NOI18N        butDuplica.setText("Duplica");        butDuplica.setFocusable(false);        butDuplica.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);        butDuplica.setMargin(new java.awt.Insets(2, 2, 2, 2));        butDuplica.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);        butDuplica.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butDuplicaActionPerformed(evt);            }        });        jToolBar1.add(butDuplica);        jLabel131.setText(" ");        jToolBar1.add(jLabel131);        butFirs.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/go-first.png"))); // NOI18N        butFirs.setMargin(new java.awt.Insets(2, 2, 2, 2));        butFirs.setMaximumSize(new java.awt.Dimension(30, 42));        butFirs.setMinimumSize(new java.awt.Dimension(30, 42));        butFirs.setPreferredSize(new java.awt.Dimension(30, 42));        butFirs.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butFirsActionPerformed(evt);            }        });        jToolBar1.add(butFirs);        butPrev.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/go-previous.png"))); // NOI18N        butPrev.setMargin(new java.awt.Insets(2, 2, 2, 2));        butPrev.setMaximumSize(new java.awt.Dimension(30, 42));        butPrev.setMinimumSize(new java.awt.Dimension(30, 42));        butPrev.setPreferredSize(new java.awt.Dimension(30, 42));        butPrev.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butPrevActionPerformed(evt);            }        });        jToolBar1.add(butPrev);        butNext.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/go-next.png"))); // NOI18N        butNext.setMargin(new java.awt.Insets(2, 2, 2, 2));        butNext.setMaximumSize(new java.awt.Dimension(30, 42));        butNext.setMinimumSize(new java.awt.Dimension(30, 42));        butNext.setPreferredSize(new java.awt.Dimension(30, 42));        butNext.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butNextActionPerformed(evt);            }        });        jToolBar1.add(butNext);        butLast.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/go-last.png"))); // NOI18N        butLast.setMargin(new java.awt.Insets(2, 2, 2, 2));        butLast.setMaximumSize(new java.awt.Dimension(30, 42));        butLast.setMinimumSize(new java.awt.Dimension(30, 42));        butLast.setPreferredSize(new java.awt.Dimension(30, 42));        butLast.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butLastActionPerformed(evt);            }        });        jToolBar1.add(butLast);        jLabel15.setText(" ");        jToolBar1.add(jLabel15);        butStampaElenco.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/document-print.png"))); // NOI18N        butStampaElenco.setText("Stampa elenco");        butStampaElenco.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);        butStampaElenco.setMargin(new java.awt.Insets(2, 2, 2, 2));        butStampaElenco.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);        butStampaElenco.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butStampaElencoActionPerformed(evt);            }        });        jToolBar1.add(butStampaElenco);        butStampa.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/document-print.png"))); // NOI18N        butStampa.setText("Stampa");        butStampa.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);        butStampa.setMargin(new java.awt.Insets(2, 2, 2, 2));        butStampa.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);        butStampa.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butStampaActionPerformed(evt);            }        });        jToolBar1.add(butStampa);        butImportExcel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/go-jump.png"))); // NOI18N        butImportExcel.setText("Import da Excel");        butImportExcel.setFocusable(false);        butImportExcel.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);        butImportExcel.setMargin(new java.awt.Insets(2, 2, 2, 2));        butImportExcel.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);        butImportExcel.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butImportExcelActionPerformed(evt);            }        });        jToolBar1.add(butImportExcel);        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridy = 1;        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTH;        gridBagConstraints.weightx = 1.0;        panAlto.add(jToolBar1, gridBagConstraints);        jToolBar2.setFloatable(false);        comFiltro1.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Visualizza Tutti", "Visualizza Clienti e Fornitori", "Visualizza Clienti", "Visualizza Fornitori", "Visualizza Provvisori" }));        comFiltro1.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                comFiltro1ActionPerformed(evt);            }        });        jToolBar2.add(comFiltro1);        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridy = 2;        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTH;        gridBagConstraints.weightx = 1.0;        panAlto.add(jToolBar2, gridBagConstraints);        jToolBar3.setFloatable(false);        jToolBar3.setRollover(true);        jLabel3.setText(" Cerca ");        jToolBar3.add(jLabel3);        texSearch.setColumns(20);        texSearch.setMaximumSize(new java.awt.Dimension(200, 20));        texSearch.setMinimumSize(new java.awt.Dimension(100, 20));        texSearch.addKeyListener(new java.awt.event.KeyAdapter() {            public void keyPressed(java.awt.event.KeyEvent evt) {                texSearchKeyPressed(evt);            }            public void keyReleased(java.awt.event.KeyEvent evt) {                texSearchKeyReleased(evt);            }        });        jToolBar3.add(texSearch);        jButton3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/edit-find.png"))); // NOI18N        jButton3.setText("Mostra Tutti");        jButton3.setBorderPainted(false);        jButton3.setFocusable(false);        jButton3.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);        jButton3.setMaximumSize(new java.awt.Dimension(110, 20));        jButton3.setPreferredSize(new java.awt.Dimension(110, 20));        jButton3.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);        jButton3.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                jButton3ActionPerformed(evt);            }        });        jToolBar3.add(jButton3);        jToolBar3.add(jSeparator2);        addFatt.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/list-add.png"))); // NOI18N        addFatt.setText("Aggiungi Fattura");        addFatt.setToolTipText("di Vendita");        addFatt.setBorderPainted(false);        addFatt.setFocusable(false);        addFatt.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);        addFatt.setMaximumSize(new java.awt.Dimension(130, 20));        addFatt.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);        addFatt.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                addFattActionPerformed(evt);            }        });        jToolBar3.add(addFatt);        addOrd.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/list-add.png"))); // NOI18N        addOrd.setText("Aggiungi Ordine");        addOrd.setToolTipText("di Vendita");        addOrd.setBorderPainted(false);        addOrd.setFocusable(false);        addOrd.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);        addOrd.setMaximumSize(new java.awt.Dimension(130, 20));        addOrd.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);        addOrd.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                addOrdActionPerformed(evt);            }        });        jToolBar3.add(addOrd);        addDdt.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/list-add.png"))); // NOI18N        addDdt.setText("Aggiungi DDT");        addDdt.setToolTipText("di Vendita");        addDdt.setBorderPainted(false);        addDdt.setFocusable(false);        addDdt.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);        addDdt.setMaximumSize(new java.awt.Dimension(110, 20));        addDdt.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);        addDdt.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                addDdtActionPerformed(evt);            }        });        jToolBar3.add(addDdt);        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridy = 3;        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTH;        gridBagConstraints.weightx = 1.0;        panAlto.add(jToolBar3, gridBagConstraints);        getContentPane().add(panAlto, java.awt.BorderLayout.NORTH);        tabCent.setName("dati"); // NOI18N        tabCent.addChangeListener(new javax.swing.event.ChangeListener() {            public void stateChanged(javax.swing.event.ChangeEvent evt) {                tabCentStateChanged(evt);            }        });        panDati.setName("dati"); // NOI18N        panDati.setPreferredSize(new java.awt.Dimension(602, 350));        panDati.setLayout(new java.awt.BorderLayout());        dati.setMinimumSize(new java.awt.Dimension(600, 400));        dati.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());        texCodiList.setBackground(new java.awt.Color(255, 204, 204));        texCodiList.setText("codice_listino");        texCodiList.setDbComboAbbinata(comList);        texCodiList.setDbNomeCampo("codice_listino");        dati.add(texCodiList, new org.netbeans.lib.awtextra.AbsoluteConstraints(685, 10, 10, -1));        texRagiSoci.setDbDescCampo("Ragione Sociale");        texRagiSoci.setDbNomeCampo("ragione_sociale");        dati.add(texRagiSoci, new org.netbeans.lib.awtextra.AbsoluteConstraints(110, 35, 300, -1));        texPiva.setDbDescCampo("Partita IVA");        texPiva.setDbNomeCampo("piva_cfiscale");        dati.add(texPiva, new org.netbeans.lib.awtextra.AbsoluteConstraints(495, 35, 135, -1));        texIndi.setDbDescCampo("Indirizzo");        texIndi.setDbNomeCampo("indirizzo");        dati.add(texIndi, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 60, 330, -1));        texProv.setDbDescCampo("Provincia");        texProv.setDbNomeCampo("provincia");        dati.add(texProv, new org.netbeans.lib.awtextra.AbsoluteConstraints(590, 85, 40, -1));        texLoca.setDbDescCampo("Località");        texLoca.setDbNomeCampo("localita");        dati.add(texLoca, new org.netbeans.lib.awtextra.AbsoluteConstraints(215, 85, 300, -1));        texTele.setDbNomeCampo("telefono");        dati.add(texTele, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 135, 145, -1));        texCap.setDbDescCampo("CAP");        texCap.setDbNomeCampo("cap");        texCap.setDbTipoCampo("");        dati.add(texCap, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 85, 60, -1));        texFax.setDbNomeCampo("fax");        dati.add(texFax, new org.netbeans.lib.awtextra.AbsoluteConstraints(290, 135, 120, -1));        texEmai.setDbDescCampo("Email");        texEmai.setDbNomeCampo("email");        dati.add(texEmai, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 185, 145, -1));        texWeb.setDbDescCampo("Sito Web");        texWeb.setDbNomeCampo("web");        dati.add(texWeb, new org.netbeans.lib.awtextra.AbsoluteConstraints(290, 185, 120, -1));        texNote.setDbNomeCampo("note");        dati.add(texNote, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 210, 330, -1));        texPersRife.setDbDescCampo("Persona di riferimento");        texPersRife.setDbNomeCampo("persona_riferimento");        texPersRife.setmaxChars(30);        dati.add(texPersRife, new org.netbeans.lib.awtextra.AbsoluteConstraints(110, 160, 210, -1));        texTeleRife.setDbNomeCampo("telefono_riferimento");        dati.add(texTeleRife, new org.netbeans.lib.awtextra.AbsoluteConstraints(390, 160, 100, -1));        texCodiFisc.setDbDescCampo("Codice Fiscale");        texCodiFisc.setDbNomeCampo("cfiscale");        dati.add(texCodiFisc, new org.netbeans.lib.awtextra.AbsoluteConstraints(495, 60, 135, -1));        texBancAbi.setDbNomeCampo("banca_abi");        texBancAbi.addFocusListener(new java.awt.event.FocusAdapter() {            public void focusLost(java.awt.event.FocusEvent evt) {                texBancAbiFocusLost(evt);            }        });        dati.add(texBancAbi, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 260, 50, -1));        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel2.setText("partita iva");        dati.add(jLabel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(415, 40, 75, -1));        jLabel21.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel21.setText("fax");        dati.add(jLabel21, new org.netbeans.lib.awtextra.AbsoluteConstraints(225, 140, 60, -1));        jLabel22.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel22.setText("listino");        dati.add(jLabel22, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 265, 45, -1));        jLabel211.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel211.setText("persona di rif.");        dati.add(jLabel211, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 165, 105, -1));        jLabel221.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel221.setText("telefono");        dati.add(jLabel221, new org.netbeans.lib.awtextra.AbsoluteConstraints(325, 165, 60, -1));        jLabel231.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel231.setText("telefono");        dati.add(jLabel231, new org.netbeans.lib.awtextra.AbsoluteConstraints(5, 140, 70, -1));        jLabel212.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel212.setText("cap");        dati.add(jLabel212, new org.netbeans.lib.awtextra.AbsoluteConstraints(35, 90, 40, -1));        jLabel222.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel222.setText("località");        dati.add(jLabel222, new org.netbeans.lib.awtextra.AbsoluteConstraints(145, 90, 60, -1));        jLabel232.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel232.setText("provincia");        dati.add(jLabel232, new org.netbeans.lib.awtextra.AbsoluteConstraints(525, 90, 60, -1));        jLabel25.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel25.setText("indirizzo");        dati.add(jLabel25, new org.netbeans.lib.awtextra.AbsoluteConstraints(5, 65, 70, -1));        jLabel241.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel241.setText("note");        dati.add(jLabel241, new org.netbeans.lib.awtextra.AbsoluteConstraints(5, 215, 70, -1));        jLabel233.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel233.setText("sito web");        dati.add(jLabel233, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 190, 55, -1));        jLabel223.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel223.setText("email");        dati.add(jLabel223, new org.netbeans.lib.awtextra.AbsoluteConstraints(25, 190, 50, -1));        jLabel213.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel213.setText("banca");        dati.add(jLabel213, new org.netbeans.lib.awtextra.AbsoluteConstraints(285, 265, 40, -1));        jLabel2111.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel2111.setText("codice");        dati.add(jLabel2111, new org.netbeans.lib.awtextra.AbsoluteConstraints(5, 15, 50, -1));        jLabel2211.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel2211.setText("ragione sociale");        dati.add(jLabel2211, new org.netbeans.lib.awtextra.AbsoluteConstraints(5, 40, 100, -1));        jLabel26.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel26.setText("codice fiscale");        dati.add(jLabel26, new org.netbeans.lib.awtextra.AbsoluteConstraints(415, 65, 75, -1));        butDest.setFont(new java.awt.Font("Dialog", 0, 11)); // NOI18N        butDest.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/emblems/emblem-system.png"))); // NOI18N        butDest.setText("<html><center>Aggiungi/Modifica<br> Destinazioni diverse</center></html>");        butDest.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butDestActionPerformed(evt);            }        });        dati.add(butDest, new org.netbeans.lib.awtextra.AbsoluteConstraints(470, 310, 155, 45));        jLabel224.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel224.setText("pagamento");        dati.add(jLabel224, new org.netbeans.lib.awtextra.AbsoluteConstraints(5, 240, 70, -1));        comList.setDbDescCampo("Listino assegnato");        comList.setDbNomeCampo("codice_listino");        comList.setDbRiempire(false);        comList.setDbSalvare(false);        comList.setDbTextAbbinato(texCodiList);        comList.setDbTipoCampo("VARCHAR");        comList.setDbTrovaMentreScrive(true);        comList.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                comListActionPerformed(evt);            }        });        dati.add(comList, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 260, 120, -1));        texCodi.setDbDescCampo("Codice");        texCodi.setDbNomeCampo("codice");        dati.add(texCodi, new org.netbeans.lib.awtextra.AbsoluteConstraints(65, 10, 50, -1));        jLabel214.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);        jLabel214.setText("abi");        dati.add(jLabel214, new org.netbeans.lib.awtextra.AbsoluteConstraints(330, 265, 25, -1));        jLabel215.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);        jLabel215.setText("cab");        dati.add(jLabel215, new org.netbeans.lib.awtextra.AbsoluteConstraints(330, 290, 30, -1));        texBancCab.setDbNomeCampo("banca_cab");        texBancCab.addFocusListener(new java.awt.event.FocusAdapter() {            public void focusLost(java.awt.event.FocusEvent evt) {                texBancCabFocusLost(evt);            }        });        dati.add(texBancCab, new org.netbeans.lib.awtextra.AbsoluteConstraints(360, 285, 50, -1));        jLabel216.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel216.setText("CC");        dati.add(jLabel216, new org.netbeans.lib.awtextra.AbsoluteConstraints(250, 315, 25, -1));        texBancCc.setDbNomeCampo("banca_cc");        dati.add(texBancCc, new org.netbeans.lib.awtextra.AbsoluteConstraints(280, 310, 170, -1));        butBanca.setText("...");        butBanca.setToolTipText("Seleziona dalla lista delle banche/filiali");        butBanca.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butBancaActionPerformed(evt);            }        });        dati.add(butBanca, new org.netbeans.lib.awtextra.AbsoluteConstraints(300, 280, 20, -1));        labBancAbi.setFont(new java.awt.Font("Dialog", 0, 11)); // NOI18N        labBancAbi.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);        labBancAbi.setText("..");        dati.add(labBancAbi, new org.netbeans.lib.awtextra.AbsoluteConstraints(415, 265, 210, -1));        labBancCab.setFont(new java.awt.Font("Dialog", 0, 11)); // NOI18N        labBancCab.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);        labBancCab.setText("..");        dati.add(labBancCab, new org.netbeans.lib.awtextra.AbsoluteConstraints(415, 290, 210, -1));        comPaga.setDbNomeCampo("pagamento");        comPaga.addItemListener(new java.awt.event.ItemListener() {            public void itemStateChanged(java.awt.event.ItemEvent evt) {                comPagaItemStateChanged(evt);            }        });        dati.add(comPaga, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 235, 160, -1));        jLabel234.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel234.setText("cellulare");        dati.add(jLabel234, new org.netbeans.lib.awtextra.AbsoluteConstraints(415, 140, 70, -1));        texCell.setDbNomeCampo("cellulare");        dati.add(texCell, new org.netbeans.lib.awtextra.AbsoluteConstraints(490, 135, 140, -1));        jLabel23.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel23.setText("paese");        dati.add(jLabel23, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 115, 45, -1));        comPaese.setDbNomeCampo("paese");        comPaese.setDbTipoCampo("");        comPaese.setDbTrovaMentreScrive(true);        dati.add(comPaese, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 110, 255, -1));        jLabel225.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel225.setText("agente");        dati.add(jLabel225, new org.netbeans.lib.awtextra.AbsoluteConstraints(375, 15, 55, -1));        comAgente.setDbDescCampo("");        comAgente.setDbNomeCampo("agente");        comAgente.setDbTipoCampo("numerico");        comAgente.setDbTrovaMentreScrive(true);        dati.add(comAgente, new org.netbeans.lib.awtextra.AbsoluteConstraints(435, 10, 120, -1));        labGiornoPagamento.setFont(labGiornoPagamento.getFont().deriveFont(labGiornoPagamento.getFont().getSize()-1f));        labGiornoPagamento.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        labGiornoPagamento.setText("giorno");        dati.add(labGiornoPagamento, new org.netbeans.lib.awtextra.AbsoluteConstraints(255, 240, 55, -1));        texGiornoPagamento.setDbNomeCampo("giorno_pagamento");        texGiornoPagamento.setDbTipoCampo("numerico");        dati.add(texGiornoPagamento, new org.netbeans.lib.awtextra.AbsoluteConstraints(315, 235, 95, -1));        jLabel226.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel226.setText("tipo");        dati.add(jLabel226, new org.netbeans.lib.awtextra.AbsoluteConstraints(120, 15, 30, -1));        comTipo.setDbDescCampo("Tipo");        comTipo.setDbNomeCampo("tipo");        comTipo.setDbTrovaMentreScrive(true);        dati.add(comTipo, new org.netbeans.lib.awtextra.AbsoluteConstraints(155, 10, 70, -1));        jLabel218.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel218.setText("IBAN");        dati.add(jLabel218, new org.netbeans.lib.awtextra.AbsoluteConstraints(225, 340, 50, -1));        tnxCheckBox1.setText("<html>stampa Dest. Diversa su Distinta Riba</html>");        tnxCheckBox1.setToolTipText("Selezionando questa opzione stampa la Destinazione diversa nella Distinta delle RIBA");        tnxCheckBox1.setDbDescCampo("Opzione Dest. Diversa Riba");        tnxCheckBox1.setDbNomeCampo("opzione_riba_dest_diversa");        tnxCheckBox1.setDbTipoCampo("");        tnxCheckBox1.setFont(tnxCheckBox1.getFont().deriveFont(tnxCheckBox1.getFont().getSize()-2f));        tnxCheckBox1.setIconTextGap(2);        tnxCheckBox1.setMaximumSize(new java.awt.Dimension(230, 25));        dati.add(tnxCheckBox1, new org.netbeans.lib.awtextra.AbsoluteConstraints(470, 360, 205, -1));        updateListini.setText("<html>Aggiorna prezzi listini\n</html>");        updateListini.setToolTipText("Seleziona se vuoi che il listino clienti venga aggiornato all'inserimento dei prezzi");        updateListini.setDbDescCampo("Aggiorna listino prezzi");        updateListini.setDbNomeCampo("flag_update_listino");        updateListini.setDbTipoCampo("");        updateListini.setFont(updateListini.getFont().deriveFont(updateListini.getFont().getSize()-2f));        updateListini.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);        updateListini.setIconTextGap(2);        updateListini.setMaximumSize(new java.awt.Dimension(230, 25));        updateListini.setVerticalAlignment(javax.swing.SwingConstants.TOP);        updateListini.setVerticalTextPosition(javax.swing.SwingConstants.TOP);        dati.add(updateListini, new org.netbeans.lib.awtextra.AbsoluteConstraints(205, 260, 80, 45));        raggruppa1.setText("raggruppa DDT ");        raggruppa1.setToolTipText("In questo modo quando si converte più DDT in fattura verranno raggruppati secondo il codice articolo e sommate le quantita");        raggruppa1.setDbDescCampo("Raggruppa DDT");        raggruppa1.setDbNomeCampo("opzione_raggruppa_ddt");        raggruppa1.setDbTipoCampo("");        raggruppa1.setMaximumSize(new java.awt.Dimension(230, 25));        dati.add(raggruppa1, new org.netbeans.lib.awtextra.AbsoluteConstraints(420, 210, 160, -1));        texBancCc2.setDbNomeCampo("banca_cc_iban");        texBancCc2.setmaxChars(27);        texBancCc2.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                texBancCc2ActionPerformed(evt);            }        });        dati.add(texBancCc2, new org.netbeans.lib.awtextra.AbsoluteConstraints(280, 335, 170, -1));        chkObsoleto.setText("Obsoleto");        chkObsoleto.setHorizontalTextPosition(javax.swing.SwingConstants.LEFT);        chkObsoleto.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                chkObsoletoActionPerformed(evt);            }        });        dati.add(chkObsoleto, new org.netbeans.lib.awtextra.AbsoluteConstraints(560, 10, -1, -1));        textObsoleto.setBackground(new java.awt.Color(255, 204, 204));        textObsoleto.setText("tnxTextField1");        textObsoleto.setDbNomeCampo("obsoleto");        dati.add(textObsoleto, new org.netbeans.lib.awtextra.AbsoluteConstraints(660, 10, 20, -1));        jLabel4.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel4.setText("logo");        dati.add(jLabel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(340, 115, 30, -1));        texLogo.setDbNomeCampo("logo");        dati.add(texLogo, new org.netbeans.lib.awtextra.AbsoluteConstraints(375, 110, 225, -1));        butLogo.setText("...");        butLogo.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);        butLogo.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butLogoActionPerformed(evt);            }        });        dati.add(butLogo, new org.netbeans.lib.awtextra.AbsoluteConstraints(600, 110, -1, -1));        tnxCheckBox2.setText("note automatiche su fattura");        tnxCheckBox2.setDbNomeCampo("note_automatiche");        dati.add(tnxCheckBox2, new org.netbeans.lib.awtextra.AbsoluteConstraints(420, 185, 190, -1));        comIvaStandard.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));        comIvaStandard.setDbNomeCampo("iva_standard");        comIvaStandard.setDbTipoCampo("CHAR");        comIvaStandard.setDbTrovaMentreScrive(true);        dati.add(comIvaStandard, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 285, 120, -1));        jLabel7.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel7.setText("IVA Standard");        dati.add(jLabel7, new org.netbeans.lib.awtextra.AbsoluteConstraints(5, 290, 70, -1));        raggruppa2.setText("stampa prezzi in DDT");        raggruppa2.setToolTipText("Seleziona se stampare o meno i prezzi nei DDT");        raggruppa2.setDbDescCampo("Stampa prezzi in DDT");        raggruppa2.setDbNomeCampo("opzione_prezzi_ddt");        raggruppa2.setDbTipoCampo("");        raggruppa2.setMaximumSize(new java.awt.Dimension(230, 25));        dati.add(raggruppa2, new org.netbeans.lib.awtextra.AbsoluteConstraints(420, 235, 160, -1));        jLabel217.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel217.setText("sconti di riga");        dati.add(jLabel217, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 340, 110, -1));        texScon1.setText("sconto1");        texScon1.setToolTipText("primo sconto");        texScon1.setDbDefault("vuoto");        texScon1.setDbDescCampo("");        texScon1.setDbNomeCampo("sconto1t");        texScon1.setDbNullSeVuoto(true);        texScon1.setDbTipoCampo("numerico");        dati.add(texScon1, new org.netbeans.lib.awtextra.AbsoluteConstraints(115, 310, 40, -1));        texScon2.setText("sconto2");        texScon2.setToolTipText("secondo sconto");        texScon2.setDbDefault("vuoto");        texScon2.setDbDescCampo("");        texScon2.setDbNomeCampo("sconto2t");        texScon2.setDbNullSeVuoto(true);        texScon2.setDbTipoCampo("numerico");        dati.add(texScon2, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 310, 40, -1));        texScon3.setText("sconto3");        texScon3.setToolTipText("terzo sconto");        texScon3.setDbDefault("vuoto");        texScon3.setDbDescCampo("");        texScon3.setDbNomeCampo("sconto3t");        texScon3.setDbNullSeVuoto(true);        texScon3.setDbTipoCampo("numerico");        dati.add(texScon3, new org.netbeans.lib.awtextra.AbsoluteConstraints(205, 310, 40, -1));        jLabel219.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel219.setText("sconti di testata");        dati.add(jLabel219, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 315, 110, -1));        texScon4.setText("sconto1");        texScon4.setToolTipText("primo sconto");        texScon4.setDbDefault("vuoto");        texScon4.setDbDescCampo("");        texScon4.setDbNomeCampo("sconto1r");        texScon4.setDbNullSeVuoto(true);        texScon4.setDbTipoCampo("numerico");        dati.add(texScon4, new org.netbeans.lib.awtextra.AbsoluteConstraints(115, 335, 40, -1));        texScon5.setText("sconto2");        texScon5.setToolTipText("secondo sconto");        texScon5.setDbDefault("vuoto");        texScon5.setDbDescCampo("");        texScon5.setDbModificato(true);        texScon5.setDbNomeCampo("sconto2r");        texScon5.setDbNullSeVuoto(true);        texScon5.setDbTipoCampo("numerico");        dati.add(texScon5, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 335, 40, -1));        jLabel227.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        jLabel227.setText("cat.");        jLabel227.setToolTipText("Categoria");        dati.add(jLabel227, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 15, 30, -1));        comTipo2.setDbDescCampo("Categoria");        comTipo2.setDbNomeCampo("tipo2");        comTipo2.setDbTrovaMentreScrive(true);        dati.add(comTipo2, new org.netbeans.lib.awtextra.AbsoluteConstraints(265, 10, 100, -1));        jScrollPane2.setViewportView(dati);        panDati.add(jScrollPane2, java.awt.BorderLayout.CENTER);        tabCent.addTab("Dati", panDati);        panElen.setName("elenco"); // NOI18N        panElen.setLayout(new java.awt.BorderLayout());        jScrollPane1.setViewportView(griglia);        panElen.add(jScrollPane1, java.awt.BorderLayout.CENTER);        tabCent.addTab("Elenco", panElen);        panPrezzi.setToolTipText("");        panPrezzi.addFocusListener(new java.awt.event.FocusAdapter() {            public void focusGained(java.awt.event.FocusEvent evt) {                panPrezziFocusGained(evt);            }        });        panPrezzi.setLayout(new java.awt.BorderLayout());        tabPrezziCliente.setFont(new java.awt.Font("Dialog", 0, 11)); // NOI18N        tabPrezziCliente.setModel(new javax.swing.table.DefaultTableModel(            new Object [][] {            },            new String [] {                "Codice Articolo", "Descrizione", "Prezzo Base", "Prezzo Cliente"            }        ) {            Class[] types = new Class [] {                java.lang.Object.class, java.lang.Object.class, java.lang.Double.class, java.lang.Double.class            };            boolean[] canEdit = new boolean [] {                false, false, false, true            };            public Class getColumnClass(int columnIndex) {                return types [columnIndex];            }            public boolean isCellEditable(int rowIndex, int columnIndex) {                return canEdit [columnIndex];            }        });        jScrollPane3.setViewportView(tabPrezziCliente);        panPrezzi.add(jScrollPane3, java.awt.BorderLayout.CENTER);        labIntePrezzi.setText("...");        jPanel3.add(labIntePrezzi);        panPrezzi.add(jPanel3, java.awt.BorderLayout.NORTH);        tabCent.addTab("Prezzi Articoli", panPrezzi);        jLabel5.setText("Note:");        griglia_rapporti.setModel(new javax.swing.table.DefaultTableModel(            new Object [][] {                {null, null, null, null},                {null, null, null, null},                {null, null, null, null},                {null, null, null, null}            },            new String [] {                "Title 1", "Title 2", "Title 3", "Title 4"            }        ));        griglia_rapporti.setComponentPopupMenu(jPopupMenu1);        griglia_rapporti.addMouseListener(new java.awt.event.MouseAdapter() {            public void mouseClicked(java.awt.event.MouseEvent evt) {                griglia_rapportiMouseClicked(evt);            }        });        jScrollPane4.setViewportView(griglia_rapporti);        jLabel6.setText("Avvisi");        btnDelRigt.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/list-remove.png"))); // NOI18N        btnDelRigt.setText("Elimina");        btnDelRigt.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                btnDelRigtActionPerformed(evt);            }        });        btnAddRow.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/list-add.png"))); // NOI18N        btnAddRow.setText("Inserisci");        btnAddRow.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                btnAddRowActionPerformed(evt);            }        });        butModiRow.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/apps/accessories-text-editor.png"))); // NOI18N        butModiRow.setText("Modifica");        butModiRow.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butModiRowActionPerformed(evt);            }        });        texTesto.setColumns(20);        texTesto.setRows(5);        texTesto.addKeyListener(new java.awt.event.KeyAdapter() {            public void keyReleased(java.awt.event.KeyEvent evt) {                texTestoKeyReleased(evt);            }        });        texAreaNoteCliente.setViewportView(texTesto);        texNotaCliente.setDbNomeCampo("nota_cliente");        org.jdesktop.layout.GroupLayout panNoteAvvisiLayout = new org.jdesktop.layout.GroupLayout(panNoteAvvisi);        panNoteAvvisi.setLayout(panNoteAvvisiLayout);        panNoteAvvisiLayout.setHorizontalGroup(            panNoteAvvisiLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)            .add(panNoteAvvisiLayout.createSequentialGroup()                .addContainerGap()                .add(panNoteAvvisiLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)                    .add(panNoteAvvisiLayout.createSequentialGroup()                        .add(panNoteAvvisiLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)                            .add(org.jdesktop.layout.GroupLayout.LEADING, panNoteAvvisiLayout.createSequentialGroup()                                .add(jLabel6)                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.UNRELATED)                                .add(butModiRow)                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)                                .add(btnAddRow)                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)                                .add(btnDelRigt))                            .add(org.jdesktop.layout.GroupLayout.LEADING, panNoteAvvisiLayout.createSequentialGroup()                                .add(jLabel5)                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.UNRELATED)                                .add(texNotaCliente, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 99, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))                        .add(0, 362, Short.MAX_VALUE))                    .add(jScrollPane4)                    .add(texAreaNoteCliente))                .addContainerGap())        );        panNoteAvvisiLayout.linkSize(new java.awt.Component[] {btnAddRow, btnDelRigt, butModiRow}, org.jdesktop.layout.GroupLayout.HORIZONTAL);        panNoteAvvisiLayout.setVerticalGroup(            panNoteAvvisiLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)            .add(panNoteAvvisiLayout.createSequentialGroup()                .addContainerGap()                .add(panNoteAvvisiLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)                    .add(jLabel5)                    .add(texNotaCliente, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)                .add(texAreaNoteCliente, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 157, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)                .add(panNoteAvvisiLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)                    .add(jLabel6)                    .add(panNoteAvvisiLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)                        .add(btnDelRigt)                        .add(btnAddRow)                        .add(butModiRow)))                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)                .add(jScrollPane4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 203, Short.MAX_VALUE)                .addContainerGap())        );        tabCent.addTab("Note & Avvisi", panNoteAvvisi);        getContentPane().add(tabCent, java.awt.BorderLayout.CENTER);        butUndo.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/actions/edit-undo.png"))); // NOI18N        butUndo.setText("Annulla");        butUndo.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butUndoActionPerformed(evt);            }        });        jPanel2.add(butUndo);        butSave.setIcon(new javax.swing.ImageIcon(getClass().getResource("/res/icons/tango-icon-theme-080/16x16/devices/media-floppy.png"))); // NOI18N        butSave.setText("Salva");        butSave.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                butSaveActionPerformed(evt);            }        });        jPanel2.add(butSave);        getContentPane().add(jPanel2, java.awt.BorderLayout.SOUTH);        pack();    }// </editor-fold>//GEN-END:initComponents    private void comFiltro1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_comFiltro1ActionPerformed//        String sql = "select codice,ragione_sociale,telefono,fax,email,web, indirizzo, cap, localita, provincia from clie_forn ";        String sql = "select " + getCampiGriglia() + " from clie_forn ";        if (comFiltro1.getSelectedIndex() == 0) {            sql += "where 1 = 1";        } else if (comFiltro1.getSelectedIndex() == 1) {            sql += "where tipo = 'C' or tipo = 'E' or tipo = 'F'";        } else if (comFiltro1.getSelectedIndex() == 2) {            sql += "where tipo = 'C' or tipo = 'E'";        } else if (comFiltro1.getSelectedIndex() == 3) {            sql += "where tipo = 'F' or tipo = 'E'";        } else if (comFiltro1.getSelectedIndex() == 4) {            sql += "where tipo = 'P'";        }        sql += " order by ragione_sociale";        griglia.dbOpen(Db.getConn(), sql);        griglia.dbRefresh();        griglia.dbSelezionaRiga();    }//GEN-LAST:event_comFiltro1ActionPerformed    private void comPagaItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_comPagaItemStateChanged        texGiornoPagamento.setEnabled(false);        try {            ResultSet r = Db.lookUp(String.valueOf(comPaga.getSelectedKey()), "codice", "pagamenti");            if (r != null) {                if (Db.nz(r.getString("flag_richiedi_giorno"), "N").equalsIgnoreCase("S")) {                    texGiornoPagamento.setEnabled(true);                }            }        } catch (Exception err) {            err.printStackTrace();        }    }//GEN-LAST:event_comPagaItemStateChanged    private void comListActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_comListActionPerformed    }//GEN-LAST:event_comListActionPerformed    private void tabCentStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_tabCentStateChanged        if (tabCent.getSelectedIndex() == 2) {            this.showPrezziCliente();        }    }//GEN-LAST:event_tabCentStateChanged    private void panPrezziFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_panPrezziFocusGained    }//GEN-LAST:event_panPrezziFocusGained    private void butStampaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butStampaActionPerformed        it.tnx.PrintUtilities.printComponent(this.dati);    }//GEN-LAST:event_butStampaActionPerformed    private void butStampaElencoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butStampaElencoActionPerformed        this.setCursor(new java.awt.Cursor(java.awt.Cursor.WAIT_CURSOR));        int[] headerWidth = {5, 15, 10, 10, 15, 6, 10, 3, 15, 15};        String nomeFilePdf = this.griglia.stampaTabella("Elenco Clienti", headerWidth);        Util.start(nomeFilePdf);        this.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));    }//GEN-LAST:event_butStampaElencoActionPerformed    private void texBancCabFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_texBancCabFocusLost        trovaCab();    }//GEN-LAST:event_texBancCabFocusLost    private void texBancAbiFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_texBancAbiFocusLost        trovaAbi();    }//GEN-LAST:event_texBancAbiFocusLost    private void butBancaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butBancaActionPerformed        CoordinateBancarie coords = new CoordinateBancarie();        coords.setField_texBancAbi(this.texBancAbi);        coords.setField_labBancAbi(this.labBancAbi);        coords.setField_texBancCab(this.texBancCab);        coords.setField_labBancCab(this.labBancCab);        /*  -- DAVID -- */        coords.setField_texIban(this.texBancCc2);        coords.setField_texContoC(this.texBancCc);        /*         frmListCoorBanc frm = new frmListCoorBanc(coords);         main.getPadre().openFrame(frm, 700, 500, 150, 50);         */        frmDatiAzieBanc frmcca = new frmDatiAzieBanc(coords);        main.getPadre().openFrame(frmcca, 700, 500, 150, 50);        /* / -- DAVID -- */    }//GEN-LAST:event_butBancaActionPerformed    private void butDestActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butDestActionPerformed        try {            frmClieDest temp = new frmClieDest(new Integer(this.texCodi.getText()).intValue(), this.texRagiSoci.getText());            main.getPadre().openFrame(temp, 500, 650);        } catch (Exception e) {            SwingUtils.showErrorMessage(main.getPadre(), "Il codice cliente non è valido");        }    }//GEN-LAST:event_butDestActionPerformed    private void butLastActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butLastActionPerformed        // Add your handling code here:        this.griglia.dbGoLast();//        setNewStato();    }//GEN-LAST:event_butLastActionPerformed    private void butNextActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butNextActionPerformed        // Add your handling code here:        this.griglia.dbGoNext();//        setNewStato();    }//GEN-LAST:event_butNextActionPerformed    private void butPrevActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butPrevActionPerformed        // Add your handling code here:        this.griglia.dbGoPrevious();//        setNewStato();    }//GEN-LAST:event_butPrevActionPerformed    private void butFirsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butFirsActionPerformed        // Add your handling code here:        this.griglia.dbGoFirst();//        setNewStato();    }//GEN-LAST:event_butFirsActionPerformed    public void updateObsoleto() {        try {            int value = Integer.parseInt(textObsoleto.getText());            if (value == 1) {                chkObsoleto.setSelected(true);            } else {                chkObsoleto.setSelected(false);            }        } catch (Exception e) {        }    }    private void formInternalFrameClosing(javax.swing.event.InternalFrameEvent evt) {//GEN-FIRST:event_formInternalFrameClosing        main.getPadre().closeFrame(this);    }//GEN-LAST:event_formInternalFrameClosing    private void butDeleActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butDeleActionPerformed        if (griglia.getSelectedRowCount() > 1) {            SwingUtils.showErrorMessage(this, "Non è possibile eliminare più Clienti alla volta");            return;        }        //prima controllo se c'? ancora qualche fattura collegata        boolean clientePresente = false;        if (texCodi.getText().trim().length() > 0) {            String sql = "select cliente from test_fatt where cliente = " + Db.pc(this.texCodi.getText(), java.sql.Types.INTEGER);            ResultSet r = Db.openResultSet(sql);            try {                if (r.next()) {                    clientePresente = true;                    javax.swing.JOptionPane.showMessageDialog(this, "Il cliente non puo' essere eliminato perche' presente in una o piu' fatture", "Attenzione", javax.swing.JOptionPane.INFORMATION_MESSAGE);                } else {                    sql = "select cliente from test_ddt where cliente = " + Db.pc(this.texCodi.getText(), java.sql.Types.INTEGER);                    r = Db.openResultSet(sql);                    if (r.next()) {                        clientePresente = true;                        javax.swing.JOptionPane.showMessageDialog(this, "Il cliente non puo' essere eliminato perche' presente in uno o piu' ddt", "Attenzione", javax.swing.JOptionPane.INFORMATION_MESSAGE);                    }                }            } catch (Exception err) {                err.printStackTrace();            }        }        if (clientePresente == false) {            int ret = JOptionPane.showConfirmDialog(this, "Sicuro di eliminare ?", "Attenzione", JOptionPane.YES_NO_OPTION);            if (ret == JOptionPane.YES_OPTION) {                String codiceListino = (String) dati.dbGetField("codice_listino");                this.dati.dbDelete();                this.griglia.dbRefresh();                this.griglia.dbSelezionaRiga();                if (main.iniPrezziCliente == true) {                    if (codiceListino.startsWith("C")) {                        //elimino automaticamente il listino abbinato a questo cliente                        String sql = "delete from tipi_listino where codice = " + Db.pc(codiceListino, java.sql.Types.VARCHAR);                        Db.executeSql(sql);                        sql = "delete from articoli_prezzi where listino = " + Db.pc(codiceListino, java.sql.Types.VARCHAR);                        Db.executeSql(sql);                    }                }            }        }    }//GEN-LAST:event_butDeleActionPerformed    private void butFindActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butFindActionPerformed        boolean ret = this.griglia.dbFindNext();        if (ret == false) {            int ret2 = JOptionPane.showConfirmDialog(this, "Posizione non trovata\nVuoi riprovare dall'inizio ?", "Attenzione", JOptionPane.YES_NO_OPTION);            //JOptionPane.showMessageDialog(this,"?-:"+String.valueOf(i));            if (ret2 == JOptionPane.OK_OPTION) {                boolean ret3 = this.griglia.dbFindFirst();            }        }    }//GEN-LAST:event_butFindActionPerformed    private void butUndoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butUndoActionPerformed        dati.dbUndo();    }//GEN-LAST:event_butUndoActionPerformed    private void butSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butSaveActionPerformed        File ftest = new File(texLogo.getText());        if (texLogo.getText().length() > 0 && !ftest.exists()) {            SwingUtils.showWarningMessage(this, "Il file del logo non esiste!");        }        if (texLogo.getText().length() > 0 && ftest.length() > 1000000) {            SwingUtils.showWarningMessage(this, "Il file del logo è troppo grande, deve essere massimo 1Mb");            return;        }        texLogo.setText(texLogo.getText().replace("\\", "\\\\"));        //controlli vari//        //controlli validità//        if (texPiva.getText().length() != 11 && texPiva.getText().length() > 0) {//            if (!SwingUtils.showYesNoMessage(this, "La lunghezza della Partita IVA non è rispettata (deve essere 11 caratteri), continuare ?")) {//                return;//            }//        }//        if ((texCodiFisc.getText().length() != 16 && texCodiFisc.getText().length() != 11) && texCodiFisc.getText().length() > 0) {//            if (!SwingUtils.showYesNoMessage(this, "La lunghezza del Codice Fiscale non è rispettata (deve essere 16 o 11 caratteri), continuare ?")) {//                return;//            }//        }        if (!controlla(controlli)) {            return;        }        this.dati.dbSave();        //salvare i prezzi listino        this.griglia.dbRefresh();        if (this.comboToRefresh != null) {            this.comboToRefresh.dbRefreshItems();            this.dispose();        }        main.events.fireInvoicexEvent(new InvoicexEvent(this, InvoicexEvent.TYPE_SAVE));        if (padre != null) {            padre.texClie.setText(texCodi.getText());            padre.recuperaDatiCliente();        }    }//GEN-LAST:event_butSaveActionPerformed    private void butNewActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butNewActionPerformed        this.dati.dbNew();        //azzero banca e filaile        this.labBancAbi.setText("");        this.labBancCab.setText("");        java.sql.Statement stat;        ResultSet resu;        //apre il resultset per ultimo +1        try {            stat = Db.getConn().createStatement();            String sql = "select codice from clie_forn order by codice desc limit 1";            resu = stat.executeQuery(sql);            if (resu.next() == true) {                this.texCodi.setText(String.valueOf(resu.getInt(1) + 1));            } else {                this.texCodi.setText("1");            }        } catch (Exception err) {            javax.swing.JOptionPane.showMessageDialog(null, err.toString());        }        this.comPaese.dbTrovaRiga("ITALY");        //se cc metto usa        if (main.getPersonalContain(main.PERSONAL_CHIANTICASHMERE)) {            this.comPaese.dbTrovaRiga("USA");        }        if (main.iniPrezziCliente == true) {            try {                if (this.texCodi.getText().trim().length() > 0) {                    Cliente c = new Cliente(Integer.parseInt(this.texCodi.getText()));                    String listinoCliente = c.getListinoCliente(true);                    this.comList.dbRefreshItems();                    this.comList.dbTrovaKey(listinoCliente);                    this.texCodiList.setText(listinoCliente);                }            } catch (Exception err) {                err.printStackTrace();            }        }        comTipo.requestFocusInWindow();    }//GEN-LAST:event_butNewActionPerformed    private void texSearchKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_texSearchKeyPressed    }//GEN-LAST:event_texSearchKeyPressed    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed        texSearch.setText("");        String sql = "select " + getCampiGriglia() + " from clie_forn";//        java.util.Hashtable colsWidthPerc = new java.util.Hashtable();//        colsWidthPerc.put("codice", new Double(10));//        colsWidthPerc.put("ragione_sociale", new Double(30));//        colsWidthPerc.put("telefono", new Double(13));//        colsWidthPerc.put("email", new Double(10));//        colsWidthPerc.put("indirizzo", new Double(0));//        colsWidthPerc.put("cap", new Double(0));//        colsWidthPerc.put("localita", new Double(0));//        colsWidthPerc.put("provincia", new Double(0));//        colsWidthPerc.put("cod fis", new Double(10));//        colsWidthPerc.put("partita iva", new Double(10));//        griglia.columnsSizePerc = colsWidthPerc;        griglia.dbOpen(Db.getConn(), sql);        griglia.dbPanel = dati;        tabCent.setSelectedIndex(1);        griglia.dbSelezionaRiga();    }//GEN-LAST:event_jButton3ActionPerformed    private void addFattActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_addFattActionPerformed        String codCliente = String.valueOf(griglia.getValueAt(griglia.getSelectedRow(), griglia.getColumnByName("codice")));        if (codCliente.equals("")) {            JOptionPane.showMessageDialog(this, "Selezionare un cliente prima di richiedere l'apertura del documento", "Errore", JOptionPane.INFORMATION_MESSAGE);        }        openForm(this.DOC_FATTURA, codCliente);    }//GEN-LAST:event_addFattActionPerformed    private void addOrdActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_addOrdActionPerformed        String codCliente = String.valueOf(griglia.getValueAt(griglia.getSelectedRow(), griglia.getColumnByName("codice")));        if (codCliente.equals("")) {            JOptionPane.showMessageDialog(this, "Selezionare un cliente prima di richiedere l'apertura del documento", "Errore", JOptionPane.INFORMATION_MESSAGE);        }        openForm(this.DOC_ORDINE, codCliente);    }//GEN-LAST:event_addOrdActionPerformed    private void addDdtActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_addDdtActionPerformed        String codCliente = String.valueOf(griglia.getValueAt(griglia.getSelectedRow(), griglia.getColumnByName("codice")));        if (codCliente.equals("")) {            JOptionPane.showMessageDialog(this, "Selezionare un cliente prima di richiedere l'apertura del documento", "Errore", JOptionPane.INFORMATION_MESSAGE);        }        openForm(this.DOC_DDT, codCliente);    }//GEN-LAST:event_addDdtActionPerformed    private void texSearchKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_texSearchKeyReleased        Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR);        String sql = "select " + getCampiGriglia() + " from clie_forn where ragione_sociale like " + Db.pc("%" + texSearch.getText() + "%", Types.VARCHAR);//        java.util.Hashtable colsWidthPerc = new java.util.Hashtable();//        colsWidthPerc.put("codice", new Double(10));//        colsWidthPerc.put("ragione_sociale", new Double(30));//        colsWidthPerc.put("telefono", new Double(13));//        colsWidthPerc.put("email", new Double(10));//        colsWidthPerc.put("indirizzo", new Double(0));//        colsWidthPerc.put("cap", new Double(0));//        colsWidthPerc.put("localita", new Double(0));//        colsWidthPerc.put("provincia", new Double(0));//        colsWidthPerc.put("cod fis", new Double(10));//        colsWidthPerc.put("partita iva", new Double(10));//        griglia.columnsSizePerc = colsWidthPerc;        griglia.dbOpen(Db.getConn(), sql);        griglia.dbPanel = dati;        tabCent.setSelectedIndex(1);        griglia.dbSelezionaRiga();        Cursor.getDefaultCursor();    }//GEN-LAST:event_texSearchKeyReleased    private void chkObsoletoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkObsoletoActionPerformed        if (chkObsoleto.isSelected()) {            textObsoleto.setText(String.valueOf(1));        } else {            textObsoleto.setText(String.valueOf(0));        }    }//GEN-LAST:event_chkObsoletoActionPerformed    private void butLogoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butLogoActionPerformed        JFileChooser fileChoose = new JFileChooser();        FileFilter filter1 = new FileFilter() {            @Override            public boolean accept(File pathname) {                if (pathname.getAbsolutePath().endsWith(".jpg")                        || pathname.getAbsolutePath().endsWith(".jpeg")                        || pathname.getAbsolutePath().endsWith(".gif")                        || pathname.getAbsolutePath().endsWith(".bmp")                        || pathname.getAbsolutePath().endsWith(".png")                        || pathname.isDirectory()) {                    return true;                } else {                    return false;                }            }            @Override            public String getDescription() {                return "File Immagine (*.jpg, *.jpeg, *.gif, *.png, *.bmp)";            }        };        fileChoose.addChoosableFileFilter(filter1);        fileChoose.setFileSelectionMode(JFileChooser.FILES_AND_DIRECTORIES);        ImagePreviewPanel preview = new ImagePreviewPanel();        fileChoose.setAccessory(preview);        fileChoose.addPropertyChangeListener(preview);        //        JFileChooser fileChoose = SwingUtils.getFileOpen(this);        //fileChoose.setCurrentDirectory(new java.io.File("c:\\"));        int ret = fileChoose.showOpenDialog(this);        if (ret == javax.swing.JFileChooser.APPROVE_OPTION) {            //apro il file            this.texLogo.setText(fileChoose.getSelectedFile().getAbsolutePath());            texLogo.setToolTipText(updateLogoPreview(texLogo.getText()));        }    }//GEN-LAST:event_butLogoActionPerformed    private void btnDelRigtActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDelRigtActionPerformed        this.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));        for (int sel : griglia_rapporti.getSelectedRows()) {            String id = String.valueOf(griglia_rapporti.getValueAt(sel, griglia_rapporti.getColumnByName("id")));            if (id.equals("null")) {                JOptionPane.showMessageDialog(this, "Seleziona almeno una riga da cancellare", "Selezione errata", JOptionPane.ERROR_MESSAGE);            } else {                Db.executeSql("DELETE FROM clie_forn_rapporti WHERE id = (" + id + ")");            }        }        griglia_rapporti.dbRefresh();        this.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));    }//GEN-LAST:event_btnDelRigtActionPerformed    private void btnAddRowActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAddRowActionPerformed        int idCliente = Integer.parseInt(this.texCodi.getText());        frmInsertRapporto frm = new frmInsertRapporto(this, idCliente, texRagiSoci.getText(), "N", 0);        main.getPadre().openFrame(frm, 580, 360);    }//GEN-LAST:event_btnAddRowActionPerformed    private void butModiRowActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butModiRowActionPerformed        this.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));        for (int sel : griglia_rapporti.getSelectedRows()) {            String id = String.valueOf(griglia_rapporti.getValueAt(sel, griglia_rapporti.getColumnByName("id")));            if (id.equals("null")) {                JOptionPane.showMessageDialog(this, "Seleziona almeno una riga da cancellare", "Selezione errata", JOptionPane.ERROR_MESSAGE);            } else {                int idCliente = Integer.parseInt(this.texCodi.getText());                frmInsertRapporto frm = new frmInsertRapporto(this, idCliente, texRagiSoci.getText(), "M", Integer.valueOf(id));                main.getPadre().openFrame(frm, 530, 360);            }        }        griglia_rapporti.dbRefresh();        this.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));    }//GEN-LAST:event_butModiRowActionPerformed    private void texTestoKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_texTestoKeyReleased        this.texNotaCliente.setText(this.texTesto.getText());        this.butSave.setEnabled(true);        this.butUndo.setEnabled(true);    }//GEN-LAST:event_texTestoKeyReleased    private void popMenuAddActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_popMenuAddActionPerformed        this.btnAddRowActionPerformed(null);    }//GEN-LAST:event_popMenuAddActionPerformed    private void popMenuDelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_popMenuDelActionPerformed        this.btnDelRigtActionPerformed(null);    }//GEN-LAST:event_popMenuDelActionPerformed    private void popMenuModActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_popMenuModActionPerformed        this.butModiRowActionPerformed(null);    }//GEN-LAST:event_popMenuModActionPerformed    private void griglia_rapportiMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_griglia_rapportiMouseClicked        try {            if (evt.getClickCount() == 2) {                this.butModiRowActionPerformed(null);            } else {                //tasto destro                //if (e.getModifiers()==InputEvent.BUTTON3_MASK) popGrig.show(tabNomi,e.getX(),e.getY());            }        } catch (Exception err) {            javax.swing.JOptionPane.showMessageDialog(null, err.toString());            err.printStackTrace();        }    }//GEN-LAST:event_griglia_rapportiMouseClicked    private void butImportExcelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butImportExcelActionPerformed        frmImportClientiExcel frm = new frmImportClientiExcel(this);        frm.pack();        main.getPadre().openFrame(frm, frm.getWidth(), frm.getHeight());}//GEN-LAST:event_butImportExcelActionPerformed    private void butDuplicaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_butDuplicaActionPerformed        if (griglia.getRowCount() <= 0) {            SwingUtils.showErrorMessage(this, "Seleziona un Cliente o Fornitore prima!");            return;        }        String sql;        String sqlC = "";        String sqlV = "";        int newNumero = 0;        int idDuplicata = 0;        int numDup = griglia.getSelectedRows().length;        int res;        //chiedo conferma per eliminare il documento        if (numDup > 1) {            SwingUtils.showErrorMessage(this, "Puoi duplicare solo un Cliente/Fornitore alla volta");            return;        } else {            res = JOptionPane.OK_OPTION;        }        if (res == JOptionPane.OK_OPTION) {            this.setCursor(new Cursor(Cursor.WAIT_CURSOR));            for (int sel : griglia.getSelectedRows()) {                int dbNumero = Integer.parseInt(String.valueOf(griglia.getValueAt(sel, griglia.getColumnByName("codice"))));                //cerco ultimo numero ordine                newNumero = 1;                sqlC = "";                sqlV = "";                sql = "SELECT MAX(codice) as maxnum FROM clie_forn";                try {                    ResultSet tempUltimo = Db.openResultSet(sql);                    if (tempUltimo.next() == true) {                        newNumero = tempUltimo.getInt("maxnum") + 1;                    }                } catch (Exception err) {                    err.printStackTrace();                }                //    SwingUtils.showInfoMessage(this, "newnumero:" + newNumero);                //inserisco nuovo salvandomi i dati su hashtable                sql = "select * from clie_forn";                sql += " where codice = " + Db.pc(dbNumero, Types.VARCHAR);                try {                    System.out.println("listmap duplica:" + sql);                    List<Map> list = DbUtils.getListMap(Db.getConn(), sql);                    Map m = list.get(0);                    m.put("codice", newNumero);                    if (main.iniPrezziCliente == true) {                        try {                            Cliente c = new Cliente(newNumero);                            String listinoCliente = c.getListinoCliente(true);                            comList.dbRefreshItems();                            m.put("codice_listino", listinoCliente);                        } catch (Exception err) {                            err.printStackTrace();                        }                    }                    sql = "insert into clie_forn set ";                    sql += DbUtils.prepareSqlFromMap(m);                    System.out.println("duplica:" + sql);                    Db.executeSql(sql);                    dbRefresh();                    //aprire il nuovo                    //cerco il dbId                    for (int row = 0; row < griglia.getRowCount(); row++) {                        if (CastUtils.toInteger0(griglia.getValueAt(row, griglia.getColumnByName("codice"))) == newNumero) {                            griglia.getSelectionModel().setSelectionInterval(row, row);                            griglia.scrollToRow(row);                            griglia.dbSelezionaRiga();                            SwingUtils.showInfoMessage(this, "Duplicato il Cliente/Fornitore " + dbNumero + " sul nuovo " + newNumero);                            break;                        }                    }                } catch (Exception err) {                    err.printStackTrace();                }            }        }        this.setCursor(new Cursor(Cursor.DEFAULT_CURSOR));}//GEN-LAST:event_butDuplicaActionPerformed    private void texBancCc2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_texBancCc2ActionPerformed        // TODO add your handling code here:    }//GEN-LAST:event_texBancCc2ActionPerformed    private void setNewStato() {        try {            System.out.println("text obsoleto:" + textObsoleto.getText());            int value = 0;            try {                value = Integer.parseInt(textObsoleto.getText());            } catch (NumberFormatException e) {            }            if (value == 1) {                chkObsoleto.setSelected(true);            } else {                chkObsoleto.setSelected(false);            }        } catch (Exception e) {            e.printStackTrace();        }        try {            if (main.getPersonalContain("adesivi") || main.getPersonalContain("noteclienti")) {                texTesto.setText(texNotaCliente.getText());                griglia_rapporti.dbOpen(Db.getConn(), "select id, cliente, data_avviso as 'Data Avviso', data as 'Data di riferimento', testo from clie_forn_rapporti where cliente = " + this.texCodi.getText());            }        } catch (Exception e) {            e.printStackTrace();        }    }    public String updateLogoPreview(String file) {        if (file.equals("")) {            File f = new File(main.wd + "icone/nologo.png");            file = f.getAbsolutePath();        }        String text = "";        File ftest = new File(file);        if (ftest.exists()) {            ImageIcon icon = new ImageIcon(file);            int lar = icon.getIconWidth();            int alt = icon.getIconHeight();            int newalt = (grandezzaTooltipImage * alt) / lar;            text += "<html><img src='file:///" + ftest.getAbsolutePath() + "' width='" + grandezzaTooltipImage + "' height = '" + newalt + "'></html>";        } else {            text += "<html><b>file inesistente</b></html>";        }        return text;    }    // Variables declaration - do not modify//GEN-BEGIN:variables    private javax.swing.JButton addDdt;    private javax.swing.JButton addFatt;    private javax.swing.JButton addOrd;    private javax.swing.JButton btnAddRow;    private javax.swing.JButton btnDelRigt;    private javax.swing.JButton butBanca;    private javax.swing.JButton butDele;    private javax.swing.JButton butDest;    private javax.swing.JButton butDuplica;    private javax.swing.JButton butFind;    private javax.swing.JButton butFirs;    private javax.swing.JButton butImportExcel;    private javax.swing.JButton butLast;    private javax.swing.JButton butLogo;    private javax.swing.JButton butModiRow;    private javax.swing.JButton butNew;    private javax.swing.JButton butNext;    private javax.swing.JButton butPrev;    private javax.swing.JButton butSave;    private javax.swing.JButton butStampa;    private javax.swing.JButton butStampaElenco;    private javax.swing.JButton butUndo;    private javax.swing.JCheckBox chkObsoleto;    private tnxbeans.tnxComboField comAgente;    private javax.swing.JComboBox comFiltro1;    private tnxbeans.tnxComboField comIvaStandard;    private tnxbeans.tnxComboField comList;    private tnxbeans.tnxComboField comPaese;    private tnxbeans.tnxComboField comPaga;    private tnxbeans.tnxComboField comTipo;    private tnxbeans.tnxComboField comTipo2;    public tnxbeans.tnxDbPanel dati;    public tnxbeans.tnxDbGrid griglia;    public tnxbeans.tnxDbGrid griglia_rapporti;    private javax.swing.JButton jButton3;    private javax.swing.JLabel jLabel1;    private javax.swing.JLabel jLabel13;    private javax.swing.JLabel jLabel131;    private javax.swing.JLabel jLabel14;    private javax.swing.JLabel jLabel15;    private javax.swing.JLabel jLabel2;    private javax.swing.JLabel jLabel21;    private javax.swing.JLabel jLabel211;    private javax.swing.JLabel jLabel2111;    private javax.swing.JLabel jLabel212;    private javax.swing.JLabel jLabel213;    private javax.swing.JLabel jLabel214;    private javax.swing.JLabel jLabel215;    private javax.swing.JLabel jLabel216;    private javax.swing.JLabel jLabel217;    private javax.swing.JLabel jLabel218;    private javax.swing.JLabel jLabel219;    private javax.swing.JLabel jLabel22;    public javax.swing.JLabel jLabel221;    private javax.swing.JLabel jLabel2211;    private javax.swing.JLabel jLabel222;    private javax.swing.JLabel jLabel223;    private javax.swing.JLabel jLabel224;    private javax.swing.JLabel jLabel225;    private javax.swing.JLabel jLabel226;    private javax.swing.JLabel jLabel227;    private javax.swing.JLabel jLabel23;    private javax.swing.JLabel jLabel231;    private javax.swing.JLabel jLabel232;    private javax.swing.JLabel jLabel233;    private javax.swing.JLabel jLabel234;    private javax.swing.JLabel jLabel241;    private javax.swing.JLabel jLabel25;    private javax.swing.JLabel jLabel26;    private javax.swing.JLabel jLabel3;    private javax.swing.JLabel jLabel4;    private javax.swing.JLabel jLabel5;    private javax.swing.JLabel jLabel6;    private javax.swing.JLabel jLabel7;    private javax.swing.JPanel jPanel2;    private javax.swing.JPanel jPanel3;    private javax.swing.JPopupMenu jPopupMenu1;    private javax.swing.JScrollPane jScrollPane1;    private javax.swing.JScrollPane jScrollPane2;    private javax.swing.JScrollPane jScrollPane3;    private javax.swing.JScrollPane jScrollPane4;    private javax.swing.JToolBar.Separator jSeparator2;    private javax.swing.JToolBar jToolBar1;    private javax.swing.JToolBar jToolBar2;    private javax.swing.JToolBar jToolBar3;    private javax.swing.JLabel labBancAbi;    private javax.swing.JLabel labBancCab;    private javax.swing.JLabel labGiornoPagamento;    private javax.swing.JLabel labIntePrezzi;    private javax.swing.JPanel panAlto;    private javax.swing.JPanel panDati;    private javax.swing.JPanel panElen;    private javax.swing.JPanel panNoteAvvisi;    private javax.swing.JPanel panPrezzi;    private javax.swing.JMenuItem popMenuAdd;    private javax.swing.JMenuItem popMenuDel;    private javax.swing.JMenuItem popMenuMod;    private tnxbeans.tnxCheckBox raggruppa1;    private tnxbeans.tnxCheckBox raggruppa2;    private javax.swing.JTabbedPane tabCent;    private javax.swing.JTable tabPrezziCliente;    private javax.swing.JScrollPane texAreaNoteCliente;    private tnxbeans.tnxTextField texBancAbi;    private tnxbeans.tnxTextField texBancCab;    private tnxbeans.tnxTextField texBancCc;    private tnxbeans.tnxTextField texBancCc2;    private tnxbeans.tnxTextField texCap;    private tnxbeans.tnxTextField texCell;    private tnxbeans.tnxTextField texCodi;    private tnxbeans.tnxTextField texCodiFisc;    private tnxbeans.tnxTextField texCodiList;    private tnxbeans.tnxTextField texEmai;    private tnxbeans.tnxTextField texFax;    private tnxbeans.tnxTextField texGiornoPagamento;    private tnxbeans.tnxTextField texIndi;    private tnxbeans.tnxTextField texLoca;    private tnxbeans.tnxTextField texLogo;    private tnxbeans.tnxTextField texNotaCliente;    private tnxbeans.tnxTextField texNote;    private tnxbeans.tnxTextField texPersRife;    private tnxbeans.tnxTextField texPiva;    private tnxbeans.tnxTextField texProv;    private tnxbeans.tnxTextField texRagiSoci;    public tnxbeans.tnxTextField texScon1;    public tnxbeans.tnxTextField texScon2;    public tnxbeans.tnxTextField texScon3;    public tnxbeans.tnxTextField texScon4;    public tnxbeans.tnxTextField texScon5;    private javax.swing.JTextField texSearch;    private tnxbeans.tnxTextField texTele;    public tnxbeans.tnxTextField texTeleRife;    private javax.swing.JTextArea texTesto;    private tnxbeans.tnxTextField texWeb;    private tnxbeans.tnxTextField textObsoleto;    private tnxbeans.tnxCheckBox tnxCheckBox1;    private tnxbeans.tnxCheckBox tnxCheckBox2;    private tnxbeans.tnxCheckBox updateListini;    // End of variables declaration//GEN-END:variables    private void trovaAbi() {        try {            this.labBancAbi.setText(Db.lookUp(this.texBancAbi.getText(), "abi", "banche_abi").getString(2));        } catch (Exception err) {            this.labBancAbi.setText("");        }    }    private void trovaCab() {        try {            String sql = "";            sql += "select banche_cab.cap,";            sql += " banche_cab.indirizzo,";            sql += " comuni.comune,";            sql += " comuni.provincia";            sql += " from banche_cab left join comuni on banche_cab.codice_comune = comuni.codice";            sql += " where banche_cab.abi = " + Db.pc(this.texBancAbi.getText(), "VARCHAR");            sql += " and banche_cab.cab = " + Db.pc(this.texBancCab.getText(), "VARCHAR");            ResultSet temp = Db.openResultSet(sql);            temp.next();            this.labBancCab.setText(Db.nz(temp.getString(3), "") + ", " + Db.nz(temp.getString(2), ""));        } catch (Exception err) {            this.labBancCab.setText("");        }    }    private void showPrezziCliente() {        isShowPrezziCliente = true;        if (main.iniPrezziCliente == true) {            int cols = 4;            String listinoBase = main.getListinoBase();            if (listinoBase.equals("-1")) {                javax.swing.JOptionPane.showMessageDialog(null, "Non e' definito il listino Base, andare in Anagrafica Listini e selezionarne uno come base.", "Attenzione", javax.swing.JOptionPane.INFORMATION_MESSAGE);                return;            }            if (this.texCodi.getText().trim().length() == 0) {                return;            }            Cliente c = new Cliente(Integer.parseInt(this.texCodi.getText()));            listinoCliente = c.getListinoCliente(true);            labIntePrezzi.setText("<html>Ragione Sociale: " + texRagiSoci.getText() + "<br>Listino Base: " + listinoBase + "<br>Listino Cliente: " + listinoCliente + "</html>");            String sql = "select a.codice, a.descrizione, ap.prezzo as prezzoBase, apc.prezzo as prezzoCliente ";            sql += " from articoli a left join articoli_prezzi ap on a.codice = ap.articolo and ap.listino = " + Db.pc(listinoBase, Types.VARCHAR);            sql += " left join articoli_prezzi apc on a.codice = apc.articolo and apc.listino = " + Db.pc(listinoCliente, Types.VARCHAR);            sql += " order by a.codice";            System.out.println("sql listini:\n" + sql);            ResultSet articoli = Db.openResultSet(sql);            DefaultTableModel model = (DefaultTableModel) tabPrezziCliente.getModel();            model.addTableModelListener(new TableModelListener() {                public void tableChanged(TableModelEvent e) {                    if (!dati.isRefreshing && !isShowPrezziCliente) {                        dati.dbForzaModificati();                    }                }            });            model.setRowCount(0);            try {                while (articoli.next()) {                    Object[] row = new Object[cols];                    row[0] = articoli.getString(1);                    row[1] = articoli.getString(2);                    if (articoli.getObject("prezzoBase") == null) {                        row[2] = null;                    } else {                        row[2] = new Double(articoli.getDouble("prezzoBase"));                    }                    if (articoli.getObject("prezzoCliente") == null) {                        row[3] = null;                    } else {                        row[3] = new Double(articoli.getDouble("prezzoCliente"));                    }                    model.addRow(row);                }//                prezziClienteModel cacheModel = new prezziClienteModel(cache, colNames, dati);//                this.tabPrezziCliente.setModel(cacheModel);                this.tabPrezziCliente.getColumn("Prezzo Base").setCellRenderer(new RendererUtils.CurrencyRenderer(0, 5));                this.tabPrezziCliente.getColumn("Prezzo Cliente").setCellRenderer(new RendererUtils.CurrencyRenderer(0, 5));                this.tabPrezziCliente.getColumn("Prezzo Cliente").setCellEditor(new EditorUtils.CurrencyEditor());            } catch (java.sql.SQLException sqlErr) {                sqlErr.printStackTrace();            }        }        isShowPrezziCliente = false;    }    private void savePrezziCliente() {        String sql;        NumberFormat form = NumberFormat.getInstance();        String prezzo;        //prima dovrei controllare i prezzi inseriti        //prima elimino i prezzi da reinserire        sql = "delete from articoli_prezzi";        sql += " where listino = " + Db.pc(listinoCliente, java.sql.Types.VARCHAR);        if (Db.executeSql(sql) == true) {            for (int i = 0; i < this.tabPrezziCliente.getRowCount(); i++) {                if (tabPrezziCliente.getValueAt(i, 3) != null && tabPrezziCliente.getValueAt(i, 3).toString().length() > 0) {//                    try {//                        prezzo = String.valueOf(form.parse(tabPrezziCliente.getValueAt(i, 3).toString()));//                    } catch (Exception err) {//                        err.printStackTrace();//                        prezzo = "0";//                    }                    Double prezzod = 0d;                    try {                        prezzod = (Double) tabPrezziCliente.getValueAt(i, 3);                    } catch (Exception e) {                        e.printStackTrace();                    }                    sql = "insert into articoli_prezzi (articolo, listino, prezzo) values (";                    sql += Db.pc(tabPrezziCliente.getValueAt(i, 0), java.sql.Types.VARCHAR);                    sql += ", " + Db.pc(listinoCliente, java.sql.Types.VARCHAR);                    sql += ", " + Db.pc(prezzod, java.sql.Types.DECIMAL);                    sql += ")";                    Db.executeSql(sql);                }            }        } else {            javax.swing.JOptionPane.showMessageDialog(this, "Impossibile eliminare i prezzi precedenti", "Errore", javax.swing.JOptionPane.ERROR_MESSAGE);        }    }    public void trova(String codice) {        dati.ultimoCampo = "codice";        dati.ultimoValore = codice;        System.out.println("find exact:" + griglia.dbFindExact());    }    private String getCampiGriglia() {        return "codice,ragione_sociale,telefono,email, indirizzo, cap, localita, provincia,cfiscale as 'cod fis', piva_cfiscale as 'partita iva'";    }    private void dbRefresh() {        dati.dbRefresh();        griglia.dbRefresh();        griglia_rapporti.dbRefresh();    }    public static class ClientiMyTable extends JTable {        //  Place cell in edit mode when it 'gains focus'        public void changeSelection(                int row, int column, boolean toggle, boolean extend) {            super.changeSelection(row, column, toggle, extend);            if (editCellAt(row, column)) {                getEditorComponent().requestFocusInWindow();            }        }        //  Select the text when the cell starts editing        //  a) text will be replaced when you start typing in a cell        //  b) text will be selected when you use F2 to start editing        //  c) text will be selected when double clicking to start editing        public boolean editCellAt(int row, int column, EventObject e) {            boolean result = super.editCellAt(row, column, e);            final Component editor = getEditorComponent();            if (editor != null && editor instanceof JTextComponent) {                if (e == null) {                    ((JTextComponent) editor).selectAll();                } else {                    SwingUtilities.invokeLater(new Runnable() {                        public void run() {                            ((JTextComponent) editor).selectAll();                        }                    });                }            }            return result;        }        //  Select the text when the cell starts editing        //  a) text will be replaced when you start typing in a cell        //  b) text will be selected when you use F2 to start editing        //  c) caret is placed at end of text when double clicking to start editing        public Component prepareEditor(                TableCellEditor editor, int row, int column) {            Component c = super.prepareEditor(editor, row, column);            if (c instanceof JTextComponent) {                System.out.println("prepare " + ((JTextField) c).getText());                ((JTextField) c).selectAll();            }            return c;        }    }}class prezziClienteModel        extends CachedTableModel {    private tnxDbPanel panel;    DecimalFormat form = new DecimalFormat("#,##0.00");    public prezziClienteModel(java.util.ArrayList rows, Object[] cols, tnxDbPanel panel) {        super(rows, cols);        this.panel = panel;    }    public boolean isCellEditable(int r, int c) {        if (c == 3) {            return true;        }        return false;    }    public Object getValueAt(int r, int c) {        if (r < cache.size()) {            if (c == 2 || c == 3) {                try {                    return form.format(((Object[]) cache.get(r))[c]);                } catch (Exception err) {                    //err.printStackTrace();                    return ((Object[]) cache.get(r))[c];                }            } else {                return ((Object[]) cache.get(r))[c];            }        } else {            return null;        }    }    public void setValueAt(Object value, int r, int c) {        super.setValueAt(value, r, c);        if (panel.dbStato != panel.DB_INSERIMENTO) {            panel.dbCambiaStato(panel.DB_MODIFICA);        }    }}